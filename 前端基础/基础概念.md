## 浏览器服务器的处理流程

#### 浏览器输入url地址到页面渲染的过程

**1、输入url后客户端发送域名给DNS服务器解析为ip地址，然后将IP地址返回给浏览器**

​	TCP/IP协议根据IP地址进行访问的，所以需要将域名请求为ip地址

**2、客户端根据IP地址连接到Web服务器**

一个HTTP客户端，通常是浏览器，与Web服务器的HTTP端口（HTTP请求默认端口为80）建立一个TCP套接字连接。

**3、三次握手建立TCP连接后发送HTTP请求**

通过TCP套接字，客户端向Web服务器发送一个文本的请求报文，一个请求报文由请求行、请求头部、空行和请求数据4部分组成。

​	**浏览器与服务器的交互过程**

​		1）首先浏览器利用tcp协议通过三次握手与服务器建立连接

　　http请求包括header和body。header中包括请求的方式（get和post）、请求的协议 （http、https、ftp）、请求的地址ip、缓存cookie。body中有请求的内容。

　　2）浏览器根据解析到的IP地址和端口号发起http的get请求.

　　3）服务器接收到http请求之后，开始搜索html页面，并使用http返回响应报文

　　4）若状态码为200显示响应成功，浏览器接收到返回的html页面之后，开始进行页面的渲染

**4、服务器接受到请求并返回HTTP响应报文**

Web服务器解析请求，定位请求资源，然后执行请求分析，查找数据库等操作后并返回一个HTTP响应。服务器将资源复本写到TCP套接字，由客户端读取。一个响应由状态行、响应头部、空行和响应数据4部分组成。

**5、四次挥手释放连接TCP连接**

若connection 模式为close，则服务器主动关闭TCP连接，客户端被动关闭连接，释放TCP连接;

若connection 模式为keepalive，则该连接会保持一段时间，在该时间内可以继续接收请求;

**6、客户端浏览器解析HTML内容**

客户端浏览器首先解析状态行，查看表明请求是否成功的状态代码。然后解析每一个响应头，响应头告知以下为若干字节的HTML文档和文档的字符集。客户端浏览器读取响应数据HTML，根据HTML的语法对其进行格式化，并在浏览器窗口中显示。

​		**浏览器页面渲染过程**

　　1）浏览器根据深度遍历的方式把html节点遍历成dom 树

　　2）将css解析成CSS DOM树

　　3）将dom树和CSS DOM树构造成render树

　　4）JS根据得到的render树 计算所有节点在屏幕中的位置，进行布局（回流）

　　5）遍历render树并调用硬件API绘制所有节点（重绘）









